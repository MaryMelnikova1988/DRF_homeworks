# DRF_homeworks
### 25.2 Валидаторы, пагинация и тесты

#### Задание 1

Для сохранения уроков и курсов реализуйте дополнительную проверку на отсутствие в материалах ссылок на сторонние ресурсы, кроме youtube.com.

То есть ссылки на видео можно прикреплять в материалы, а ссылки на сторонние образовательные платформы или личные сайты — нельзя.

Создайте отдельный файл validators.py, реализуйте валидатор, проверяющий ссылку, которую пользователь хочет записать в поле урока с помощью класса или функции.

Интегрируйте валидатор в сериализатор.

Если вы используете функцию-валидатор — указанием валидаторов для поля сериализатора 
validators=[ваш_валидатор].

Если вы используете класс-валидатор — указанием валидаторов в 
class Meta:
validators = [ваш_валидатор(field='поле_которое_валидируем')]

#### Задание 2

Добавьте модель подписки на обновления курса для пользователя.

Модель подписки должна содержать следующие поля: 
1. «пользователь» (FK  на модель пользователя), 
2. «курс» (FK =  на модель курса). 

Можете дополнительно расширить модель при необходимости.

Вам необходимо реализовать эндпоинт для установки подписки пользователя и на удаление подписки у пользователя.

_Подсказка_

Воспользуйтесь APIView и реализуйте логику метода post, который будет отдавать ответ в зависимости от действия.

Пример кода метода postь для управления подпиской:

def post(self, *args, **kwargs):
    user = получаем пользователя из self.requests
    course_id = получаем id курса из self.reqests.data
    course_item = получаем объект курса из базы с помощью get_object_or_404

    subs_item = получаем объекты подписок по текущему пользователю и курса

		# Если подписка у пользователя на этот курс есть - удаляем ее
    if subs_item.exists():
        ...
        message = 'подписка удалена'
		# Если подписки у пользователя на этот курс нет - создаем ее
    else:
        ...
        message = 'подписка добавлена'
		# Возвращаем ответ в API
    return Response({"message": message})

Зарегистрируйте новый контроллер в url  и проверьте его работоспособность в Postman.

При этом при выборке данных по курсу пользователю необходимо присылать признак подписки текущего пользователя на курс. 
То есть давать информацию, подписан пользователь на обновления курса или нет.

_Подсказка_ 

Чтобы реализовать это, используйте SerializerMethodField() с соответсвующим методом или вложенный сериализатор для подписки.

#### Задание 3

Реализуйте пагинацию для вывода всех уроков и курсов.

Пагинацию реализуйте в отдельном файле paginators.py. 
Можно реализовать один или несколько классов пагинатора. Укажите параметры  для класса PageNumberPagination: 
1. page_size , 
2. page_size_query_param, 
3. max_page_size

Количество элементов на странице выберите самостоятельно. Интегрируйте пагинатор в контроллеры, используя параметр 
pagination_class
.

#### Задание 4

Напишите тесты, которые будут проверять корректность работы CRUD уроков и функционал работы подписки на обновления курса.

В тестах используйте метод setUp для заполнения базы данных тестовыми данными. Обработайте возможные варианты взаимодействия с контроллерами пользователей с разными правами доступа. Для аутентификации пользователей используйте 
self.client.force_authenticate(). Документацию к этому методу можно найти тут.

Сохраните результат проверки покрытия тестами.

#### Дополнительное задание

Напишите тесты на все имеющиеся эндпоинты в проекте.

Дополнительное задание, помеченное звездочкой, желательно, но не обязательно выполнять.

